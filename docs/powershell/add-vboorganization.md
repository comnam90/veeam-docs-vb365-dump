---
title: "Add-VBOOrganization"
product: "vb365"
doc_type: "powershell"
source_url: "https://helpcenter.veeam.com/docs/vbo365/powershell/add-vboorganization.html"
last_updated: "1/14/2026"
product_version: "8.3.0.2201"
---

  + [VBOAmazonSubnet](vboamazonsubnet.html "VBOAmazonSubnet")
  + [VBOAmazonVpc](vboamazonvpc.html "VBOAmazonVpc")
  + [VBOApplication](vboapplication.html "VBOApplication")
  + [VBOApplicationOnlyConnectionSettings](vboapplicationonlyconnectionsettings.html "VBOApplicationOnlyConnectionSettings")
  + [VBOAzureArchiverAppliance](vboazurearchiverappliance.html "VBOAzureArchiverAppliance")
  + [VBOAzureBlobAccount](vboazureblobaccount.html "VBOAzureBlobAccount")
  + [VBOAzureBlobConnectionSettings](vboazureblobconnectionsettings.html "VBOAzureBlobConnectionSettings")
  + [VBOAzureBlobContainer](vboazureblobcontainer.html "VBOAzureBlobContainer")
  + [VBOAzureBlobFolder](vboazureblobfolder.html "VBOAzureBlobFolder")
  + [VBOAzureBlobObjectStorageApplianceInfo](vboazureblobobjectstorageapplianceinfo.html "VBOAzureBlobObjectStorageApplianceInfo")
  + [VBOAzureBlobObjectStorageRepository](vboazureblobobjectstoragerepository.html "VBOAzureBlobObjectStorageRepository")
  + [VBOAzureLocation](vboazurelocation.html "VBOAzureLocation")
  + [VBOAzureResourceGroup](vboazureresourcegroup.html "VBOAzureResourceGroup")
  + [VBOAzureServiceAccount](vboazureserviceaccount.html "VBOAzureServiceAccount")
  + [VBOAzureSubnet](vboazuresubnet.html "VBOAzureSubnet")
  + [VBOAzureSubscription](vboazuresubscription.html "VBOAzureSubscription")
  + [VBOAzureVirtualMachineSize](vboazurevirtualmachinesize.html "VBOAzureVirtualMachineSize")
  + [VBOAzureVirtualNetwork](vboazurevirtualnetwork.html "VBOAzureVirtualNetwork")
  + [VBOBackupAccount](vbobackupaccount.html "VBOBackupAccount")
  + [VBOBackupApplication](vbobackupapplication.html "VBOBackupApplication")
  + [VBOBackupDistributionGroup](vbobackupdistributiongroup.html "VBOBackupDistributionGroup")
  + [VBOBackupDynamicDistributionGroup](vbobackupdynamicdistributiongroup.html "VBOBackupDynamicDistributionGroup")
  + [VBOBackupGroup](vbobackupgroup.html "VBOBackupGroup")
  + [VBOBackupItem](vbobackupitem.html "VBOBackupItem")
  + [VBOBackupO365Group](vbobackupo365group.html "VBOBackupO365Group")
  + [VBOBackupOrganization](vbobackuporganization.html "VBOBackupOrganization")
  + [VBOBackupPersonalSites](vbobackuppersonalsites.html "VBOBackupPersonalSites")
  + [VBOBackupPublicMailbox](vbobackuppublicmailbox.html "VBOBackupPublicMailbox")
  + [VBOBackupSecurityGroup](vbobackupsecuritygroup.html "VBOBackupSecurityGroup")
  + [VBOBackupSharedMailbox](vbobackupsharedmailbox.html "VBOBackupSharedMailbox")
  + [VBOBackupSite](vbobackupsite.html "VBOBackupSite")
  + [VBOBackupTeam](vbobackupteam.html "VBOBackupTeam")
  + [VBOBackupUser](vbobackupuser.html "VBOBackupUser")
  + [VBOBackupWindowSettings](vbobackupwindowsettings.html "VBOBackupWindowSettings")
  + [VBOCopyJob](vbocopyjob.html "VBOCopyJob")
  + [VBOCopyJobSchedulePolicy](vbocopyjobschedulepolicy.html "VBOCopyJobSchedulePolicy")
  + [VBODataRetrieval](vbodataretrieval.html "VBODataRetrieval")
  + [VBODataRetrievalSession](vbodataretrievalsession.html "VBODataRetrievalSession")
  + [VBOEmailSettings](vboemailsettings.html "VBOEmailSettings")
  + [VBOEncryptionKey](vboencryptionkey.html "VBOEncryptionKey")
  + [VBOExchangeOnPremConnectionSettings](vboexchangeonpremconnectionsettings.html "VBOExchangeOnPremConnectionSettings")
  + [VBOFederatedAuthenticationAuthority](vbofederatedauthenticationauthority.html "VBOFederatedAuthenticationAuthority")
  + [VBOFolderExclusions](vbofolderexclusions.html "VBOFolderExclusions")
  + [VBOGlobalRetentionExclusion](vboglobalretentionexclusion.html "VBOGlobalRetentionExclusion")
  + [VBOHistorySettings](vbohistorysettings.html "VBOHistorySettings")
  + [VBOInternetProxySettings](vbointernetproxysettings.html "VBOInternetProxySettings")
  + [VBOJob](vbojob.html "VBOJob")
  + [VBOJobSchedulePolicy](vbojobschedulepolicy.html "VBOJobSchedulePolicy")
  + [VBOJobSession](vbojobsession.html "VBOJobSession")
  + [VBOJobStatistics](vbojobstatistics.html "VBOJobStatistics")
  + [VBOLicense](vbolicense.html "VBOLicense")
  + [VBOLicensedUser](vbolicenseduser.html "VBOLicensedUser")
  + [VBOLicensingOptions](vbolicensingoptions.html "VBOLicensingOptions")
  + [VBOLinuxCredential](vbolinuxcredential.html "VBOLinuxCredential")
  + [VBOObjectStorageRepository](vboobjectstoragerepository.html "VBOObjectStorageRepository")
  + [VBOOffice365ConnectionSettings](vbooffice365connectionsettings.html "VBOOffice365ConnectionSettings")
  + [VBOOffice365LegacyConnectionSettings](vbooffice365legacyconnectionsettings.html "VBOOffice365LegacyConnectionSettings")
  + [VBOOfficeLicense](vboofficelicense.html "VBOOfficeLicense")
  + [VBOOnPremConnectionSettings](vboonpremconnectionsettings.html "VBOOnPremConnectionSettings")
  + [VBOOperatorRole](vbooperatorrole.html "VBOOperatorRole")
  + [VBOOrganization](vboorganization.html "VBOOrganization")
  + [VBOOrganizationGroup](vboorganizationgroup.html "VBOOrganizationGroup")
  + [VBOOrganizationGroupMember](vboorganizationgroupmember.html "VBOOrganizationGroupMember")
  + [VBOOrganizationRetentionExclusion](vboorganizationretentionexclusion.html "VBOOrganizationRetentionExclusion")
  + [VBOOrganizationSite](vboorganizationsite.html "VBOOrganizationSite")
  + [VBOOrganizationSynchronizationState](vboorganizationsynchronizationstate.html "VBOOrganizationSynchronizationState")
  + [VBOOrganizationTeam](vboorganizationteam.html "VBOOrganizationTeam")
  + [VBOOrganizationUser](vboorganizationuser.html "VBOOrganizationUser")
  + [VBOProxy](vboproxy.html "VBOProxy")
  + [VBOProxyInternetProxySettings](vboproxyinternetproxysettings.html "VBOProxyInternetProxySettings")
  + [VBOProxyPool](vboproxypool.html "VBOProxyPool")
  + [VBORbacGroup](vborbacroleitem_2.html "VBORbacGroup")
  + [VBORbacOperator](vborbacoperator.html "VBORbacOperator")
  + [VBORbacOrganizationRoleItem](vborbacorganizationroleitem.html "VBORbacOrganizationRoleItem")
  + [VBORbacPersonalSites](vborbacpersonalsites.html "VBORbacPersonalSites")
  + [VBORbacRoleItem](vborbacroleitem.html "VBORbacRoleItem")
  + [VBORbacSite](vborbacsite.html "VBORbacSite")
  + [VBORbacTeam](vborbacteam.html "VBORbacTeam")
  + [VBORbacUser](vborbacuser.html "VBORbacUser")
  + [VBORepositoriesOwnerChangeSession](vborepositoriesownerchangesession.html "VBORepositoriesOwnerChangeSession")
  + [VBORepository](vborepository.html "VBORepository")
  + [VBORepositorySynchronizeSession](vborepositorysynchronizesession.html "VBORepositorySynchronizeSession")
  + [VBORepositoryUpgradeSession](vborepositoryupgradesession.html "VBORepositoryUpgradeSession")
  + [VBORestAPISettings](vborestapisettings.html "VBORestAPISettings")
  + [VBORestoreLogItem](vborestorelogitem.html "VBORestoreLogItem")
  + [VBORestorePoint](vborestorepoint.html "VBORestorePoint")
  + [VBORestorePortalSettings](vborestoreportalsettings.html "VBORestorePortalSettings")
  + [VBORestoreSession](vborestoresession.html "VBORestoreSession")
  + [VBOS3Account](vbos3account.html "VBOS3Account")
  + [VBOS3ConnectionSettings](vbos3connectionsettings.html "VBOS3ConnectionSettings")
  + [VBOSecuritySettings](vbosecuritysettings.html "VBOSecuritySettings")
  + [VBOServer](vboserver.html "VBOServer")
  + [VBOServerComponent](vboservercomponent.html "VBOServerComponent")
  + [VBOSharePointOnPremConnectionSettings](vbosharepointonpremconnectionsettings.html "VBOSharePointOnPremConnectionSettings")
  + [VBOTenantAuthenticationSettings](vbotenantauthenticationsettings.html "VBOTenantAuthenticationSettings")
  + [VBOUsageData](vbousagedata.html "VBOUsageData")
  + [VBOVersion](vboversion.html "VBOVersion")
* [Veeam Backup for Microsoft 365 PowerShell Changelog](ps_changelog.html "Veeam Backup for Microsoft 365 PowerShell Changelog")
  + [v8 Changelog](changelog.html "v8 Changelog")
    - [New and Updated Cmdlets](new_updated_cmdlets.html "New and Updated Cmdlets")
    - [Deprecated Cmdlets](deprecated_cmdlets.html "Deprecated Cmdlets")
  + [v8.1 Changelog](changelog_81.html "v8.1 Changelog")
  + [v8.1.1 Changelog](changelog_811.html "v8.1.1 Changelog")
  + [v8.2 Changelog](changelog_82.html "v8.2 Changelog")
  + [v8.3 Changelog](changelog_83.html "v8.3 Changelog")

>[PowerShell Reference](https://helpcenter.veeam.com/docs/vbo365/powershell/)>[Veeam Backup for Microsoft 365 PowerShell Reference](./veeam_psreference.md)>[Organizations Management](./organizations_management.md)>[Organizations](./organizations.md)>Add-VBOOrganization

# Add-VBOOrganization


Short Description

Adds Microsoft organizations to the Veeam Backup for Microsoft 365 infrastructure.

Syntax

|  |
| --- |
| Add-VBOOrganization [-Name <String>] [-Description <String>] [-Office365ExchangeConnectionsSettings <VBOOffice365ConnectionSettings>] [-Office365SharePointConnectionsSettings <VBOOffice365ConnectionSettings>] [-OnPremExchangeConnectionSettings <VBOExchangeOnPremConnectionSettings>] [-OnPremSharePointConnectionSettings <VBOSharePointOnPremConnectionSettings>] [-Region <VBOOffice365Region>] [-VeeamAADApplicationUsed] [-EnableOffice365Teams] [-EnableTeamsChats] [<CommonParameters>] |

Detailed Description

This cmdlet adds Microsoft organizations to the Veeam Backup for Microsoft 365 infrastructure. You can add the following types of Microsoft organizations:

* Microsoft 365 organizations to back up Microsoft Exchange Online and Microsoft SharePoint Online with Microsoft OneDrive for Business.
* On-premises Microsoft organizations to back up a Microsoft Exchange server and a Microsoft SharePoint server.
* Hybrid organizations to back up both Microsoft 365 organizations and On-premises Microsoft organizations.

For more information on Hybrid types of organizations, see the [Adding Hybrid Organizations](https://helpcenter.veeam.com/docs/vbo365/guide/vbo_add_hybrid.html?ver=80) section of the Veeam Backup for Microsoft 365 User Guide.

When you add Microsoft organizations to the Veeam Backup for Microsoft 365 infrastructure, you can specify one of the following authentication methods that the cmdlet will use to connect to a Microsoft server:

* Modern app-only authentication. This type of authentication utilizes a Microsoft Entra application. Run the [New-VBOOffice365ApplicationOnlyConnectionSettings](new-vbooffice365applicationonlyconnectionsettings.md) cmdlet to define Microsoft Entra application settings.
* Modern authentication with legacy protocols allowed. Run the [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md) cmdlet to define connection settings with legacy authentication protocols.
* Basic authentication. Run the [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md) cmdlet to define connection settings with legacy authentication protocols.

|  |
| --- |
| ![Add-VBOOrganization](images/icon_important.webp) Important |
| Since [Microsoft deprecated basic authentication and legacy authentication protocols](https://techcommunity.microsoft.com/t5/exchange-team-blog/basic-authentication-deprecation-in-exchange-online-september/ba-p/3609437), adding Microsoft organizations using these authentication methods will be deprecated in future versions of Veeam Backup for Microsoft 365. |

If you want to add Microsoft 365 organizations that will include both Microsoft Exchange Online and Microsoft SharePoint Online with Microsoft OneDrive for Business services, you must set the [VBOOffice365ConnectionSettings](vbooffice365connectionsettings.md) object that contains authentication settings to connect to Microsoft 365 organizations, to the same type of authentication mode.

Run the [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md) cmdlet to create the [VBOOffice365ConnectionSettings](vbooffice365connectionsettings.md) object.

Parameters

| Parameter | Description | Type | Required | Position | Accept Pipeline Input |
| --- | --- | --- | --- | --- | --- |
| Name | Specifies a name of the Microsoft organization. The cmdlet will add an organization with this name. | String | False | Named | False |
| Description | Specifies a description of the Microsoft organization. | String | False | Named | False |
| Office365ExchangeConnectionsSettings | Specifies connection settings. The cmdlet will use these settings to add Microsoft Exchange Online to Veeam Backup for Microsoft 365.  Note: If you also want to add Microsoft SharePoint Online to the same Microsoft 365 organization, you must set the [VBOOffice365ConnectionSettings](vbooffice365connectionsettings.md) object to the same type of authentication mode. | Accepts the [VBOOffice365ConnectionSettings](vbooffice365connectionsettings.md) object.  To create this object, run the [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md) cmdlet. | False | Named | False |
| Office365SharePointConnectionsSettings | Specifies connection settings. The cmdlet will use these settings to add Microsoft SharePoint Online and Microsoft OneDrive for Business to Veeam Backup for Microsoft 365.  Note: If you also want to run the cmdlet with the Office365ExchangeConnectionsSettings parameter, you must set the [VBOOffice365ConnectionSettings](vbooffice365connectionsettings.md) object to the same type of authentication mode. | Accepts the [VBOOffice365ConnectionSettings](vbooffice365connectionsettings.md) object.  To create this object, run the [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md) cmdlet. | False | Named | False |
| OnPremExchangeConnectionSettings | Specifies connection settings. The cmdlet will use these settings to add Microsoft on-premises Exchange organization to Veeam Backup for Microsoft 365. | Accepts the [VBOExchangeOnPremConnectionSettings](vboexchangeonpremconnectionsettings.md) object.  To create this object, run the [New-VBOOnPremConnectionSettings](new-vboonpremconnectionsettings.md) cmdlet. | False | Named | False |
| OnPremSharePointConnectionSettings | Specifies connection settings. The cmdlet will use these settings to add Microsoft on-premises SharePoint organization to Veeam Backup for Microsoft 365. | Accepts the [VBOSharePointOnPremConnectionSettings](vbosharepointonpremconnectionsettings.md) object.  To create this object, run the [New-VBOOnPremConnectionSettings](new-vboonpremconnectionsettings.md) cmdlet. | False | Named | False |
| Region | Specifies Microsoft Entra region where Microsoft 365 organization datacenter is located:   * China * Germany * USDefence * USGovernment * Worldwide   Default: Worldwide | VBOOffice365Region | False | Named | False |
| VeeamAADApplicationUsed | Defines that the cmdlet will use the Veeam application to connect to Microsoft Graph.  Note: You must set this parameter to true for the following Microsoft Entra regions:   * China * Germany   Default: False | SwitchParameter | False | Named | False |
| EnableOffice365Teams | Defines that the cmdlet will add Microsoft Teams to Veeam Backup for Microsoft 365. To do this, the cmdlet will use settings specified with the Office365SharePointConnectionsSettings parameter.  Default: True  Note: If you want to use this parameter, you must also provide the Office365ExchangeConnectionsSettings and Office365SharePointConnectionsSettings parameters. | SwitchParameter | False | Named | False |
| EnableTeamsChats | For Microsoft organizations with modern app-only authentication.  Defines that the cmdlet will enable backup of team chats.  Default: False | SwitchParameter | False | Named | False |

<CommonParameters>

This cmdlet supports Microsoft PowerShell common parameters. For more information on common parameters, see the [About CommonParameters](http://go.microsoft.com/fwlink/p/?LinkID=113216) section of Microsoft Docs.

Output Object

The cmdlet returns the [VBOOrganization](vboorganization.md) object that contains settings of a Microsoft organization added to the Veeam Backup for Microsoft 365 infrastructure.

Examples for Modern App-Only Authentication

These examples provide instructions on adding Microsoft organizations to the Veeam Backup for Microsoft 365 infrastructure using the modern app-only authentication method.

![](//img.veeam.com/helpcenter/baggage/arrow_next.svg)Example 1: Adding Microsoft Organization to Back Up Several Microsoft Services

|  |  |
| --- | --- |
| This example shows how to add a Microsoft organization to the Veeam Backup for Microsoft 365 infrastructure to back up the following services:   * Microsoft Exchange Online. * Microsoft SharePoint Online and Microsoft OneDrive for Business. * Microsoft Teams and team chats.   |  | | --- | | $securepassword = Read-Host "Enter your password" -AsSecureString  Enter your password: \*\*\*\*\*\*\*\*\*\*  $appSettings = New-VBOOffice365ApplicationOnlyConnectionSettings -ApplicationCertificatePath "C:\certificate\cert.pfx" -ApplicationCertificatePassword $securepassword -ApplicationId 6c957a12-93fd-469a-86f6-1dc3cc81cf07 -ConfigureApplication  Add-VBOOrganization -Office365ExchangeConnectionsSettings $appSettings -Office365SharePointConnectionsSettings $appSettings -EnableTeamsChats  WARNING: To sign in, use a web browser to open the page https://microsoft.com/devicelogin and enter the code CHYX3QM33 to authenticate. |  Perform the following steps:   1. Run the [Read-Host](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/read-host?view=powershell-7.5) cmdlet. Specify the message that the console will display as a prompt. Provide the AsSecureString parameter. Save the result to the $securepassword variable. 2. Enter the password. 3. Run the [New-VBOOffice365ApplicationOnlyConnectionSettings](new-vbooffice365applicationonlyconnectionsettings.md) cmdlet. Specify the ApplicationCertificatePath, ApplicationCertificatePassword, ApplicationId and ConfigureApplication parameters. Save the result to the $appSettings variable. 4. Run the Add-VBOOrganization cmdlet. Set the $appSettings variable as the Office365ExchangeConnectionsSettings parameter value. Set the $appSettings variable as the Office365SharePointConnectionsSettings parameter value. Provide the EnableTeamsChats parameter. 5. Open the <https://microsoft.com/devicelogin> webpage in a browser and provide the authentication code that you get in the warning output. |

![](//img.veeam.com/helpcenter/baggage/arrow_next.svg)Example 2: Adding Microsoft Organization Together with Defining Microsoft Entra Application Using Certificate

|  |  |
| --- | --- |
| This example shows how to add a Microsoft organization to the Veeam Backup for Microsoft 365 infrastructure and define settings of a Microsoft Entra application using the certificate.  |  | | --- | | $securepassword = Read-Host "Enter your password" -AsSecureString  Enter your password: \*\*\*\*\*\*\*\*\*\*  $newapp = New-VBOOffice365ApplicationOnlyConnectionSettings -ApplicationCertificatePath "C:\certificate\cert.pfx" -ApplicationCertificatePassword $securepassword -NewApplicationName "Application05"  Add-VBOOrganization -Office365ExchangeConnectionsSettings $newapp -Office365SharePointConnectionsSettings $newapp  WARNING: To sign in, use a web browser to open the page https://microsoft.com/devicelogin and enter the code CHYX3QM33 to authenticate. |  Perform the following steps:   1. Run the [Read-Host](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/read-host?view=powershell-7.5) cmdlet. Specify the message that the console will display as a prompt. Provide the AsSecureString parameter. Save the result to the $securepassword variable. 2. Enter the password. 3. Run the [New-VBOOffice365ApplicationOnlyConnectionSettings](new-vbooffice365applicationonlyconnectionsettings.md) cmdlet. Specify the ApplicationCertificatePath, ApplicationCertificatePassword and NewApplicationName parameters. Save the result to the $newapp variable. 4. Run the Add-VBOOrganization cmdlet. Set the $newapp variable as the Office365ExchangeConnectionsSettings parameter value. Set the $newapp variable as the Office365SharePointConnectionsSettings parameter value. 5. Open the <https://microsoft.com/devicelogin> webpage in a browser and provide the authentication code that you get in the warning output. |

![](//img.veeam.com/helpcenter/baggage/arrow_next.svg)Example 3: Adding Microsoft Organization to Back Up SharePoint Online

|  |  |
| --- | --- |
| This example shows how to add a Microsoft organization to the Veeam Backup for Microsoft 365 infrastructure.  |  | | --- | | $securepassword = Read-Host "Enter your password" -AsSecureString  Enter your password: \*\*\*\*\*\*\*\*\*\*  $appSettings = New-VBOOffice365ApplicationOnlyConnectionSettings -OfficeOrganizationName @tech-365.tech -ApplicationId 22b5dd21-5ccf-4696-8482-eda0a1c7d32b -ApplicationCertificatePath "C:\certificate\cert.pfx" -ApplicationCertificatePassword $securepassword  Add-VBOOrganization -Office365SharePointConnectionsSettings $appSettings |  Perform the following steps:   1. Run the [Read-Host](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/read-host?view=powershell-7.5) cmdlet. Specify the message that the console will display as a prompt. Provide the AsSecureString parameter. Save the result to the $securepassword variable. 2. Enter the password. 3. Run the [New-VBOOffice365ApplicationOnlyConnectionSettings](new-vbooffice365applicationonlyconnectionsettings.md) cmdlet. Specify the OfficeOrganizationName, ApplicationId, ApplicationCertificatePath, ApplicationCertificatePassword parameters. Save the result to the $appSettings variable. 4. Run the Add-VBOOrganization cmdlet. Set the $appSettings variable as the Office365SharePointConnectionsSettings parameter value. |

Examples for Modern Authentication and Legacy Protocols

These examples provide instructions on adding Microsoft organizations to the Veeam Backup for Microsoft 365 infrastructure using modern authentication with legacy protocols allowed.

![](//img.veeam.com/helpcenter/baggage/arrow_next.svg)Example 4: Adding Microsoft Organization to Back Up Exchange Online

|  |  |
| --- | --- |
| This example shows how to add a Microsoft organization to the Veeam Backup for Microsoft 365 infrastructure. Veeam Backup for Microsoft 365 will back up Microsoft Exchange Online.  |  | | --- | | $credentials = Get-Credential  $connection = New-VBOOffice365ConnectionSettings -Credential $Credentials -GrantRolesAndPermissions  Add-VBOOrganization -Name "ABC Organization" -Office365ExchangeConnectionsSettings $connection |  Perform the following steps:   1. Run the [Get-Credential](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-credential?view=powershell-7.5) cmdlet. Enter credentials. Save the result to the $credentials variable.  1. Run the [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md) cmdlet. Set the $credentials as the Credential parameter value. Provide the GrantRolesAndPermissions parameter. Save the result to the $connection variable. 2. Run the Add-VBOOrganization cmdlet. Specify the Name parameter value. Set the $connection variable as the Office365ExchangeConnectionsSettings parameter value. |

![](//img.veeam.com/helpcenter/baggage/arrow_next.svg)Example 5: Adding Microsoft Organization to Back Up Several Microsoft Services

|  |  |
| --- | --- |
| This example shows how to add a Microsoft organization to the Veeam Backup for Microsoft 365 infrastructure to back up the following services:   * Microsoft Exchange Online. * Microsoft SharePoint Online and Microsoft OneDrive for Business.   |  | | --- | | $credentials = Get-Credential  $connection = New-VBOOffice365ConnectionSettings -Credential $Credentials -GrantRolesAndPermissions  Add-VBOOrganization -Name "ABC Organization" -Office365ExchangeConnectionsSettings $connection -Office365SharePointConnectionsSettings $connection |  Perform the following steps:   1. Run the [Get-Credential](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-credential?view=powershell-7.5) cmdlet. Enter credentials. Save the result to the $credentials variable. 2. Run the [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md) cmdlet. Set the $credentials as the Credential parameter value. Provide the GrantRolesAndPermissions parameter. Save the result to the $connection variable. 3. Run the Add-VBOOrganization cmdlet. Specify the following settings:  * Specify the Name parameter value. * Set the $connection variable as the Office365ExchangeConnectionsSettings parameter value. * Set the $connection variable as the Office365SharePointConnectionsSettings parameter value. |

![](//img.veeam.com/helpcenter/baggage/arrow_next.svg)Example 6: Adding On-Premises Microsoft Organizations to Back Up Microsoft Exchange Server

|  |  |
| --- | --- |
| This example shows how to add an on-premises Microsoft organization to back up Microsoft Exchange server.  |  | | --- | | $Credentials = Get-Credential  $onPremSettings = New-VBOOnPremConnectionSettings -Credential $Credentials -ServerName Support.North  Add-VBOOrganization -Name "ABC Organization" -OnPremExchangeConnectionSettings $onPremSettings |  Perform the following steps:   1. Run the [Get-Credential](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-credential?view=powershell-7.5) cmdlet. Enter credentials you want to use for authenticating to a Microsoft Exchange on-premises organization. Save the result to the $Credentials variable. 2. Run the [New-VBOOnPremConnectionSettings](new-vboonpremconnectionsettings.md) cmdlet. Set the $Credentials variable as the Credential parameter value. Specify the ServerName parameter value. Save the result to the $onPremSettings variable. 3. Run the Add-VBOOrganization cmdlet. Specify the Name parameter value. Set the $onPremSettings variable as the OnPremExchangeConnectionSettings parameter value. |

Related Commands

* [Get-Credential](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-credential?view=powershell-7.5)
* [Read-Host](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/read-host?view=powershell-7.5)
* [New-VBOOffice365ApplicationOnlyConnectionSettings](new-vbooffice365applicationonlyconnectionsettings.md)
* [New-VBOOffice365ConnectionSettings](new-vbooffice365connectionsettings.md)
* [New-VBOOnPremConnectionSettings](new-vboonpremconnectionsettings.md)


